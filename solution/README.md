### **README.md**
# CSVServer Assignment
---

## Prerequisites

1. Docker should be installed on your machine.
   Check it with the command : docker --version
2. Clone the Repository: 
   Ensure the `solution` directory is available and contains the following files:
   - `gencsv.sh`
   - `inputdata`
   - `part-1-cmd`
   - `part-1-output`
   - `part-1-logs`

---

## Instructions

### **1. Generate the Input Data File**
The application requires a file named `inputdata` to run. Use the provided `gencsv.sh` script to generate this file.

1. Make the script executable:
   ```bash
   chmod +x gencsv.sh
   ```

2. Run the script:
   ```bash
   ./gencsv.sh 2 8
   ```

   This will create a file named `inputdata` in the current directory with 7 lines of data. Example content:
   ```csv
   2, 234
   3, 987
   4, 12
   5, 456
   6, 789
   7, 123
   8, 99
   ```

---

### **2. Build and Run the Docker Container**

#### **Build the Docker Image**
If the Docker image `demoserver:1.0` is not available, build it using the provided `Dockerfile`:
```bash
cd demoserver
docker build -t demoserver:1.0 .
```

#### **Run the Docker Container**
Start the container with the following command:
```bash
docker run -d --name csvserver \
  -v "$(pwd)/inputdata:/csvserver/inputdata" \
  -e CSVSERVER_BORDER=Orange \
  -p 9393:9300 \
  demoserver:1.0
```

- **Flags Explanation:**
  - `-d`: Run the container in detached mode (background).
  - `--name csvserver`: Name of the container.
  - `-v "$(pwd)/inputdata:/csvserver/inputdata"`: Mount the `inputdata` file into the container.
  - `-e CSVSERVER_BORDER=Orange`: Set the border color for the application.
  - `-p 9393:9300`: Expose the application on host port `9393`.

#### **Verify the Container**
Check if the container is running:
```bash
docker ps
```

---

### **3. Access the Application**

1. Open a browser and navigate to:
   ```
   http://localhost:9393
   ```
2. You should see:
   - A table displaying the content of the `inputdata` file.
   - A welcome note with an orange border.

---

### **4. Verify the Application**

#### **Fetch Raw Data**
Retrieve the raw CSV data from the `/raw` endpoint:
```bash
curl -o part-1-output http://localhost:9393/raw
```

#### **Container Logs**
View the application logs:
```bash
docker logs csvserver >& part-1-logs
```

---

### **5. Cleanup**

When you're done, stop and remove the container:
```bash
docker stop csvserver
docker rm csvserver
```

---

## Files Description

| File Name       | Description                                                                                  |
|------------------|----------------------------------------------------------------------------------------------|
| `gencsv.sh`      | Bash script to generate the `inputdata` file with index and random numbers.                 |
| `inputdata`      | CSV file containing the test data for the `csvserver` application.                          |
| `part-1-cmd`     | Command used to run the `csvserver` container with required environment variables.           |
| `part-1-output`  | Output fetched from the `/raw` endpoint of the `csvserver` application.                     |
| `part-1-logs`    | Logs generated by the `csvserver` container.                                                |

---

## Troubleshooting

1. **Container Fails to Start:**
   - Ensure the `inputdata` file exists and is correctly formatted.
   - Check the logs for errors:
     ```bash
     docker logs csvserver
     ```

2. **If facing an issue of demoserver permission issue, for example**
   ```bash
   docker: Error response from daemon: failed to create task for container: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: error during container init: exec: "/demoserver/demoserver": permission denied: unknown.
   ```
   - Kindly do 'chmod +x demoserver/demoserver first and then try to build the image.

2. **Port Conflict:**
   - Ensure no other application is using port `9393` on your machine.

3. **Access Issues:**
   - Verify that the Docker container is running:
     ```bash
     docker ps
     ```

4. **Missing Docker Image:**
   - If the `demoserver:1.0` image is missing, build it using the Dockerfile:
     ```bash
     cd demoserver
     docker build -t demoserver:1.0 .
     ```

---

## Conclusion

By following these steps, you will successfully run the `csvserver` application.